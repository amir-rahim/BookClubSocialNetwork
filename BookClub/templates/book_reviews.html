{% extends 'base_content.html' %}

{% block page_title %}
{{ book.title }}
{% endblock page_title %}

{% block page_subtitle %}
These are the reviews for {{book.title}}
{% endblock page_subtitle %}

{% block content %}

<div class="columns">

    <div class="column is-3">

        <aside class="menu is-hidden-mobile" style="padding-left: 15px;">

            <p class="menu-label">Club Views</p>

            <ul class="menu-list">
            </ul>

            <p class="menu-label">Forum & Reviews</p>

            <ul class="menu-list">
                <li><a>Forum</a></li>
                <li><a>Members Reviews</a></li>
            </ul>

        </aside>

    </div>
    
    <div class="column is-9">
        <div class="box">
            <form method="post" action="{% url 'home' %}">
                {% csrf_token %}
                <button class="button is-fullwidth is-light">Add Review</button>
            </form>
        </div>
            
        {% if reviews %} <!-- If there are clubs available to the logged-in user -->
        <div class="table-container">
           <table class="table is-hoverable is-fullwidth" id="table-books" data-toggle="table" data-pagination="true">
              <thead>
                  <tr>
                      <th scope="col">User</th>
                      <th scope="col">Rating</th>
                      <th scope="col">Text</th>
                      <th scope="col">Reviewed On</th>
                      <th cope="col"></th>
                  </tr>
              </thead>
              <tbody>
                  {% for review in reviews %}
                      <tr onclick="window.location='{% url 'home' %}';">
                          <td>{{review.user}}</td>
                          <td>{{review.rating}}</td>
                          <td>{{review.review}}</td>
                          <td>{{review.createdOn}}</td>
                          {% if review.user == request.user %}
                            <td><form method="get" action="{% url 'book_reviews' book.id %}">
                                <button class="button is-danger is-outlined">
                                    <span>Delete</span>
                                </button>
                              </form></td>
                          {% else %}
                                <td></td>
                          {% endif %}
                      </tr>
                  {% endfor %}
              </tbody>
          </table>
        </div>
                
        {% else %}
            <div class="box">
                <p> No reviews as of yet </p>
            </div>
        {%endif%}
    </div>


</div>

<script>
    const dataTable = new simpleDatatables.DataTable("#table-books", {
        fixedHeight: true,
        columns: [
          {select: [1], sortable:false}
        ]
    })
</script>

{% endblock %}